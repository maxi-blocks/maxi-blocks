{"version":3,"file":"react-svg.cjs.development.js","sources":["../compiled/shallow-differs.js","../compiled/ReactSVG.js"],"sourcesContent":["// Hat-tip: https://github.com/developit/preact-compat/blob/master/src/index.js#L402.\nconst shallowDiffers = (a, b) => {\n    for (const i in a) {\n        if (!(i in b)) {\n            return true;\n        }\n    }\n    for (const i in b) {\n        if (a[i] !== b[i]) {\n            return true;\n        }\n    }\n    return false;\n};\nexport default shallowDiffers;\n","import { SVGInjector } from '@tanem/svg-injector';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport ReactDOMServer from 'react-dom/server';\nimport shallowDiffers from './shallow-differs';\nexport class ReactSVG extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.initialState = {\n            hasError: false,\n            isLoading: true\n        };\n        this.state = this.initialState;\n        this._isMounted = false;\n        this.refCallback = (container) => {\n            this.container = container;\n        };\n    }\n    renderSVG() {\n        /* istanbul ignore else */\n        if (this.container instanceof Node) {\n            const { beforeInjection, evalScripts, renumerateIRIElements, src } = this.props;\n            /* eslint-disable @typescript-eslint/no-non-null-assertion */\n            const afterInjection = this.props.afterInjection;\n            const Wrapper = this.props.wrapper;\n            /* eslint-enable @typescript-eslint/no-non-null-assertion */\n            const wrapper = document.createElement(Wrapper);\n            wrapper.innerHTML = ReactDOMServer.renderToStaticMarkup(React.createElement(Wrapper, null,\n                React.createElement(Wrapper, { \"data-src\": src })));\n            this.svgWrapper = this.container.appendChild(wrapper.firstChild);\n            const afterEach = (error, svg) => {\n                if (error) {\n                    this.removeSVG();\n                }\n                // TODO: It'd be better to cleanly unsubscribe from SVGInjector\n                // callbacks instead of tracking a property like this.\n                if (this._isMounted) {\n                    this.setState(() => ({\n                        hasError: !!error,\n                        isLoading: false\n                    }), () => {\n                        afterInjection(error, svg);\n                    });\n                }\n            };\n            SVGInjector(this.svgWrapper.firstChild, {\n                afterEach,\n                beforeEach: beforeInjection,\n                evalScripts,\n                renumerateIRIElements\n            });\n        }\n    }\n    removeSVG() {\n        if (this.container instanceof Node && this.svgWrapper instanceof Node) {\n            this.container.removeChild(this.svgWrapper);\n            this.svgWrapper = null;\n        }\n    }\n    componentDidMount() {\n        this._isMounted = true;\n        this.renderSVG();\n    }\n    componentDidUpdate(prevProps) {\n        if (shallowDiffers(prevProps, this.props)) {\n            this.setState(() => this.initialState, () => {\n                this.removeSVG();\n                this.renderSVG();\n            });\n        }\n    }\n    componentWillUnmount() {\n        this._isMounted = false;\n        this.removeSVG();\n    }\n    render() {\n        /* eslint-disable @typescript-eslint/no-unused-vars */\n        const { afterInjection, beforeInjection, evalScripts, fallback: Fallback, loading: Loading, renumerateIRIElements, src, wrapper, ...rest } = this.props;\n        /* eslint-enable @typescript-eslint/no-unused-vars */\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const Wrapper = wrapper;\n        return (React.createElement(Wrapper, Object.assign({}, rest, { ref: this.refCallback }),\n            this.state.isLoading && Loading && React.createElement(Loading, null),\n            this.state.hasError && Fallback && React.createElement(Fallback, null)));\n    }\n}\nReactSVG.defaultProps = {\n    afterInjection: () => undefined,\n    beforeInjection: () => undefined,\n    evalScripts: 'never',\n    fallback: null,\n    loading: null,\n    renumerateIRIElements: true,\n    wrapper: 'div'\n};\nReactSVG.propTypes = {\n    afterInjection: PropTypes.func,\n    beforeInjection: PropTypes.func,\n    evalScripts: PropTypes.oneOf(['always', 'once', 'never']),\n    fallback: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string\n    ]),\n    loading: PropTypes.oneOfType([\n        PropTypes.func,\n        PropTypes.object,\n        PropTypes.string\n    ]),\n    renumerateIRIElements: PropTypes.bool,\n    src: PropTypes.string.isRequired,\n    wrapper: PropTypes.oneOf(['div', 'span'])\n};\n"],"names":["shallowDiffers","a","b","i","ReactSVG","arguments","initialState","hasError","isLoading","state","_isMounted","refCallback","container","renderSVG","Node","props","beforeInjection","evalScripts","renumerateIRIElements","src","afterInjection","Wrapper","wrapper","document","createElement","innerHTML","ReactDOMServer","renderToStaticMarkup","React","svgWrapper","appendChild","firstChild","afterEach","error","svg","removeSVG","setState","SVGInjector","beforeEach","removeChild","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","render","Fallback","fallback","Loading","loading","rest","Object","assign","ref","defaultProps","undefined","propTypes","PropTypes","isRequired"],"mappings":"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"}