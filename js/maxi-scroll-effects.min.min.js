class ScrollEffects{constructor(){this.scrollData=this.getElements(),this.init(),this.oldValue=0}init(){this.startingEffect(),document.addEventListener("DOMContentLoaded",[this.getElements.bind(this),this.startingEffect.bind(this)]),window.addEventListener("scroll",this.effectsOnScroll.bind(this))}getElements=()=>{const t={};return Array.from(document.querySelectorAll("[data-scroll-effect-type]")).forEach((e=>{const{id:s}=e;t[s]={},e?.getAttribute("data-scroll-effect-type")?.trim()?.split(" ").forEach((a=>{t[s][a]=this.getScrollData(e,a)}))})),t};setTransform=(t,e,s)=>{const a=t.style.transform;if(null==a)return t.style.transform=e,t.style.WebkitTransform=e,null;const r=a.split(") ");return r.map(((t,e)=>(t.includes(s)&&r.splice(e,1),null))),t.style.transform=r.join(" ")+e,t.style.WebkitTransform=r.join(" ")+e,null};setOpacity=(t,e)=>{t.style.opacity=e};setBlur=(t,e)=>{t.style.filter=`blur(${e})`};setVertical=(t,e)=>{t.style.top=`${e}px`};setHorizontal=(t,e)=>{t.style.left=`${e}px`};applyStyle(t,e,s){switch(e){case"rotate":this.setTransform(t,`rotate(${s}deg)`,"rotate");break;case"fade":this.setOpacity(t,`${s}%`);break;case"scale":this.setTransform(t,`scale3d(${s}%, ${s}%, ${s}%)`,"scale");break;case"blur":this.setBlur(t,`${s}px`);break;case"vertical":this.setVertical(t,s);break;case"horizontal":this.setHorizontal(t,s)}return null}getScrollSetting=t=>{const e={},s=t.trim().split(" ");return e.speedValue=parseFloat(s[0])||200,e.delayValue=parseFloat(s[1])||0,e.easingValue=s[2]||"ease",e.trigger=(t=>{switch(t){case"top":return 100;case"mid":return 50;case"bottom":default:return 0}})(s[3]),e.reverseScroll=s[4]||!0,e.start=parseInt(s[5]),e.mid=parseInt(s[6]),e.end=parseInt(s[7]),e};getScrollData=(t,e)=>t.getAttribute(`data-scroll-effect-${e}-general`);startingTransform(t,e){const s=this.getScrollData(t,e);if(!s||!t)return null;const{start:a}=this.getScrollSetting(s);return this.applyStyle(t,e,a),null}getScrollDirection=()=>{const t=window.pageYOffset;let e="";return e=this.oldValue<=t?"down":"up",this.oldValue=t,e};scrollTransform=(t,e,s)=>{let a=0,r=0,l=0,n=0;const c=this.getScrollData(t,e);if(!c)return;const{trigger:o,start:i,mid:h,end:u,reverseScroll:f}=this.getScrollSetting(c),d=t.getBoundingClientRect(),b=window.innerHeight,g=b/2,m=t.offsetHeight/2;let p=0;switch(o){case 50:p=g;break;case 0:p=b}let y=Math.round(d.top),M=Math.round(d.bottom);0!==p&&(y-=p,M-=p);const S=Math.round(y+m);if("down"===s&&y<=0)if(r=0,a=0,S>=0){const s=Math.abs((Math.abs(i)-Math.abs(h))/m);i<h?l+=s:l-=s;const a=Math.abs(Math.trunc(i+l))<h?Math.trunc(i+l):h;this.applyStyle(t,e,a)}else{const s=Math.abs((Math.abs(u)-Math.abs(h))/m);h<u?n+=s:n-=s;const a=Math.abs(Math.trunc(n+h))<u?Math.trunc(n+h):u;this.applyStyle(t,e,a)}if("true"===f&&"up"===s&&M>=0)if(n=0,l=0,S<=0){const s=Math.abs((Math.abs(u)-Math.abs(h))/m);u<h?r+=s:r-=s;const a=Math.abs(Math.trunc(r+u))<h?Math.trunc(r+u):h;this.applyStyle(t,e,a)}else{const s=Math.abs((Math.abs(h)-Math.abs(i))/m);h>i?a-=s:a+=s;const r=Math.abs(Math.trunc(a+h))<i?Math.trunc(a+h):i;this.applyStyle(t,e,r)}};effectsOnScroll=()=>{const t=this.getScrollDirection();Object.entries(this.scrollData).forEach((([e,s])=>{const a=document.getElementById(e);Object.entries(s).forEach((([e])=>{this.scrollTransform(a,e,t)}))}))};startingEffect(){Object.entries(this.scrollData).forEach((([t,e])=>{let s="";const a=document.getElementById(t);Object.entries(e).forEach((([t,e])=>{const{speedValue:r,easingValue:l,delayValue:n}=this.getScrollSetting(e);switch(t){case"vertical":s+=`top ${r}ms ${l} ${n}ms, `;break;case"horizontal":s+=`left ${r}ms ${l} ${n}ms, `;break;case"rotate":case"scale":s+=`transform ${r}ms ${l} ${n}ms, `;break;case"fade":s+=`opacity ${r}ms ${l} ${n}ms, `;break;case"blur":s+=`filter ${r}ms ${l} ${n}ms, `}this.startingTransform(a,t)})),""!==s&&(a.style.transition=s.substring(0,s.length-2))}))}}window.addEventListener("DOMContentLoaded",(()=>{new ScrollEffects}));
