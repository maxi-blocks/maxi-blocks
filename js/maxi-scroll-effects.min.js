class ScrollEffects{constructor(){this.scrollData=this.getElements(),this.init(),this.oldValue=0}init(){this.startingEffect(),document.addEventListener("DOMContentLoaded",[this.getElements.bind(this),this.startingEffect.bind(this)]),window.addEventListener("scroll",this.effectsOnScroll.bind(this))}getElements=()=>{const t={};return Array.from(document.querySelectorAll("[data-scroll-effect-type]")).forEach((e=>{const{id:s}=e;t[s]={};e?.getAttribute("data-scroll-effect-type")?.trim()?.split(" ").forEach((r=>{t[s][r]=this.getScrollData(e,r)}))})),t};setTransform=(t,e,s)=>{const r=t.style.transform;if(null==r)return t.style.transform=e,t.style.WebkitTransform=e,null;const l=r.split(") ");return l.map(((t,e)=>(t.includes(s)&&l.splice(e,1),null))),t.style.transform=l.join(" ")+e,t.style.WebkitTransform=l.join(" ")+e,null};setOpacity=(t,e)=>{t.style.opacity=e};setBlur=(t,e)=>{t.style.filter=`blur(${e})`};setVertical=(t,e)=>{t.style.top=`${e}px`};setHorizontal=(t,e)=>{t.style.left=`${e}px`};applyStyle(t,e,s){switch(e){case"rotate":this.setTransform(t,`rotate(${s}deg)`,"rotate");break;case"fade":this.setOpacity(t,`${s}%`);break;case"scale":this.setTransform(t,`scale3d(${s}%, ${s}%, ${s}%)`,"scale");break;case"blur":this.setBlur(t,`${s}px`);break;case"vertical":this.setVertical(t,s);break;case"horizontal":this.setHorizontal(t,s)}return null}getScrollSetting=t=>{const e={},s=t.trim().split(" ");return e.speedValue=parseFloat(s[0])||200,e.delayValue=parseFloat(s[1])||0,e.easingValue=s[2]||"ease",e.trigger=(t=>{switch(t){case"top":return 100;case"mid":return 50;case"bottom":default:return 0}})(s[3]),e.reverseScroll=s[4]||!0,e.start=parseInt(s[5]),e.mid=parseInt(s[6]),e.end=parseInt(s[7]),e};getScrollData=(t,e)=>t.getAttribute(`data-scroll-effect-${e}-general`);startingTransform(t,e){const s=this.getScrollData(t,e);if(!s||!t)return null;const{start:r}=this.getScrollSetting(s);return this.applyStyle(t,e,r),null}getScrollDirection=()=>{const t=window.pageYOffset;let e="";return e=this.oldValue<=t?"down":"up",this.oldValue=t,e};scrollTransform=(t,e,s)=>{const r=this.getScrollData(t,e);if(!r)return;const l=s,{trigger:a,start:n,mid:i,end:o,reverseScroll:c}=this.getScrollSetting(r),f=t.getBoundingClientRect(),h=window.innerHeight,d=h/2,u=t.offsetHeight/2;let g=0;switch(a){case 50:g=d;break;case 0:g=h}let m=Math.round(f.top),p=Math.round(f.bottom);0!==g&&(m-=g,p-=g);const y=Math.round(m+u);"down"===l&&m<=0&&(y>=0?this.applyStyle(t,e,i):this.applyStyle(t,e,o)),"true"===c&&"up"===l&&p>=0&&(y<=0?this.applyStyle(t,e,i):this.applyStyle(t,e,n))};effectsOnScroll=()=>{const t=this.getScrollDirection();Object.entries(this.scrollData).forEach((([e,s])=>{const r=document.getElementById(e);Object.entries(s).forEach((([e])=>{this.scrollTransform(r,e,t)}))}))};startingEffect(){Object.entries(this.scrollData).forEach((([t,e])=>{let s="";const r=document.getElementById(t);Object.entries(e).forEach((([t,e])=>{const{speedValue:l,easingValue:a,delayValue:n}=this.getScrollSetting(e);switch(t){case"vertical":s+=`top ${l}ms ${a} ${n}ms, `;break;case"horizontal":s+=`left ${l}ms ${a} ${n}ms, `;break;case"rotate":case"scale":s+=`transform ${l}ms ${a} ${n}ms, `;break;case"fade":s+=`opacity ${l}ms ${a} ${n}ms, `;break;case"blur":s+=`filter ${l}ms ${a} ${n}ms, `}this.startingTransform(r,t)})),""!==s&&(r.style.transition=s.substring(0,s.length-2))}))}}window.addEventListener("DOMContentLoaded",(()=>{new ScrollEffects}));
